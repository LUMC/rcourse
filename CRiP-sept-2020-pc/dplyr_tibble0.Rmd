---
title: 'tibble'
# author: "R. Monajemi"
params:
  basename: "dplyr_tibble0"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(comment = NA, paged.print=FALSE)
build_nocode(params)  
```

 
```{r, echo=FALSE, results='asis'}
alert_block(params)
``` 

`r todo( "Must be added here that 'library(tidyverse)' must be executed first. Both at the console and at the top of the Rmd file." )`

`r todo( "ThisOrNext:" )` A tibble is a two dimensional data structure with rows and columns, also referred to as `observations` 
and `variables`. I'll use these terms interchangeably depending on the context. The variables may take 
any [atomic type](basic_vectors0.html) such as character,integer etc. Let's start by creating one manually.

A **tibble** is a table -- a two dimensional data structure with rows (**observations**) and columns (**variables**).  
I'll use these terms interchangeably depending on the context.  
Each variable has a fixed [type](basic_vectors0.html) such as `character`, `integer` etc.  
Let's start by creating a tibble manually.

## Create a tibble    
 
`r todo( "ThisOrNext:" )` Creating a __tibble__ is done using the keyword `tibble` taking a list of `key=value` pairs with `key` being the variable name and `value` the values of the observations.

Creating a __tibble__ is done using the keyword _tibble_ taking a list of `key=value` pairs where:

- `key` is the variable (column) name,
- `value` provides the values of the observations. 

Take for example the variables `name`, `year` and `colour` to represent a person's name, birth year and favourite colour:   

`r todo( "is favourite_color the optimal name? Maybe persons? Or persons_data?" )`

```{r, echo=TRUE}
favourite_color  <- tibble(name=c("Lucas","Lotte","Noa","Wim"), 
                           year=c(1995,1995,1995,1994), 
                           colour=c("Blue","Green","Yellow","Purple"))
```

`r todo( "ThisOrNext:" )` The object `favourite_color` now holds the data. Enter it's name in the R console for inspection:

The variable `favourite_color` now holds the data.  
Enter its name in the R `Console` for inspection:

```{r}
favourite_color
```

> What additional pieces of information do you see beside the content we provided?

```{r, echo=FALSE, results='asis'}
msg <- "1) '# A tibble: 4 x 3', which says that this is a tibble with dimensions 4x3 (4 observations 
and 3 variables), \n\n 2) the atomic type of each variable, in this case character and double, \n\n 3) the row numbers"
qa(msg)
``` 

## Type of tibble

`r todo( "Maybe move this section to very end? It is less important than e.g. ncol/nrow" )`

Now inspect the type of the tibble object we just created:

```{r}
class(favourite_color)
```

`r todo( "Put extra info icon here" )`
As you can see a tibble is in its core a base R `data.frame` with some additional behaviour enforced by `tbl_df` and `tbl` types.  
In this course we will be working mainly with tibbles rather than base R data.frame.  
However, for those of you interested in the differences between 
tibble and data.frame please see [tibble vs data.frame*](dplyr_tibble1.html).

## Inspect your data

Type the following to find out the dimensions of the tibble:

```{r}
ncol(favourite_color)  # number of variables (columns)
nrow(favourite_color)  # number of observatons (rows)
dim(favourite_color)   # dimensions 
```

or top and bottom rows of the tibble: 

```{r}
head(favourite_color, 2)  # first 2 observations (rows)
tail(favourite_color, 3)  # last 3 observations (rows)
```

## subsetting:  [

Often you may need to select certain variable, this can be done using square brackets `[` :

```{r}
favourite_color["colour"]
```

to subset combination of variables:

```{r}
favourite_color[c("name","year")]
```
 
`r info_block("Subset result of a tibble is always a tibble.")`

## Extract variables as vectors:  [[ or $

If you want to work with variables as individual vectors then you can do this either by double square brackets or $ sign: 

```{r}
favourite_color[["year"]]
favourite_color$year
```

## tibble to/from file

Tibbles can be written to data files and read back again. Many data formats exist but for brevity we will be using
comma-separated-value (csv) format in this course. The functions involved for this purpose ar `write_csv` and `read_csv`.
For more details on reading/writing format see [readr_io0](readr_io0.html).

let us now save our first tibble into a file in csv format:   

```{r}
write_csv(x = favourite_color, path = "data/favourite_color.csv")
```

`favourite_color` tibble is written to `favourite_color.csv` text file in sub-directory `data`. You may inspect the file with any editor and it should look something like: 

```
name,year,colour
Lucas,1995,Blue
Lotte,1995,Green
Noa,1995,Yellow
Wim,1994,Purple
```

This way we can permanently store our results in files for later use. We can now read the csv file back into a R 
object, e.g. `favourite_color_csv` :

```{r}
favourite_color_csv <- read_csv(file = "data/favourite_color.csv")
```

`read_csv` gives a summary of the variables and their inferred types.

```{r}
favourite_color_csv
```

```{r, child="_exercises_links.Rmd"}
``` 

```{r, child="_related.Rmd"} 
``` 

```{r, echo=FALSE, results='asis'}
alert_block(params)
``` 
