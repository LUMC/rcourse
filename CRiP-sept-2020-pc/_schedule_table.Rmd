```{r _shedule, echo=FALSE}
conf <- yaml.load_file("_schedule.yml")
slots <- conf[["course"]][["slots"]]
.f <- function( id ) sapply( slots, function( s ) if( is.null( s[[id]] ) ) NA else s[[id]] )

barmsijs <- FALSE
if( barmsijs ) {
  sitePrefix <- 'https://barmsijs.lumc.nl/crip/'
} else {
  sitePrefix <- paste0('file://',knitr::opts_knit$get("output.dir"),'/_site/')
}
.url <- function( ids ) {
  sapply( ids, function( id ) {
    paste0( sitePrefix, id, ".html" )
  })
}
  
d <- tibble( 
  id = names( slots ), title = .f( "title" ), 
  nextId = .f( "next" ), prevId = .f( "prev" ) ,
  date = .f( "date" ), time = .f( "time" ), 
  slot = ordered( as.integer( .f( "slot" ) ) ),
  slotPos = as.integer( .f( "slotPos" ) ),
) %>%
  filter( !is.na( slotPos ) ) %>% 
  mutate( id = factor( id, levels = id ) ) %>% 
  mutate( nextId = factor( nextId, levels = id ) ) %>% 
  mutate( prevId = factor( prevId, levels = id ) ) %>% 
  mutate( decoTitle = paste0( "<a href=",.url( id )," target=\"_self\">", title ,"</a>" )) %>%
  arrange( slot, slotPos )

kableExtra::kable(
  d %>% select( `Slot` = slot, `Date` = date, `Time` = time, `Topic` = decoTitle ), 
  format = "pipe",
  escape = FALSE
) %>%
  kableExtra::kable_paper("striped", full_width = TRUE) %>%
  kableExtra::group_rows( index = table( fct_inorder( d$slot ) ) )
```

